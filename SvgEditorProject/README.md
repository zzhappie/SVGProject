## SvgEditor项目

## 项目介绍

这是一个基于 Qt 框架开发的 SVG 编辑器项目。它提供了一个图形用户界面，已实现的功能如下：

1.图形绘制：允许用户用鼠标在绘图区域拖动来实现创建各种 SVG 图形元素，如自由线、直线、矩形、圆形、五边形、六边形、五角星、心形、气泡和文本。

2.图形编辑：

- 单个图形：点击左侧工具栏中的箭头按钮，可选中图形，进行移动以及拖动图形边界来调整宽高，还可实现复制、粘贴、剪切、删除以及撤销/重做操作。
- 多个图形：按住ctrl键同时选中多个图形，可以实现对多个图形的移动和复制、粘贴、剪切、删除以及撤销/重做操作。

3.绘图窗口：

- 点击左侧工具栏中的放大镜按钮，同时滚动鼠标滚轮，可以对画布进行缩放
- 点击鼠标右键，唤出画布菜单栏，可以实现图层的顺序调整

4.参数栏设置：

- 在参数栏中，用户可以为当前选中图形设置填充颜色、边界颜色、边界宽度和边框样式，并同步显示在绘图窗口中。
- 用户还可为画布设置画布宽度、高度、颜色以及缩放比例，并同步显示在绘图窗口中。
- 通过放大镜按钮+鼠标滚轮实现画布缩放的比例，也会同步显示在参数栏中。
- 通过箭头按钮+拖动图形边界实现调整图形的宽度和高度，也会同步显示在参数栏中。

5.文件管理：顶部文件菜单栏实现了新建画布、加载与保存svg、导出png等功能

6.配置管理：实现了左侧工具栏按钮的悬停提示功能。

**7.待开发的功能**：

- 本地配置
- 多文件管理
- 多线程：主线程负责UI交互（如画布操作、控件响应）和最终渲染结果的展示；工作线程处理耗时任务（如**解析大型SVG文件**、应用复杂渲染、批量处理图形元素）。线程间通信——信号和槽机制：工作线程解析完SVG文件后，发送信号通知主线程更新UI。

## 简历写法

**SVG编辑器**

**应用技术：**C++11、Qt信号槽、设计模式、QSS、HTTP、JSON报文

**项目描述：**这是一个基于Qt 框架开发的 SVG 编辑器项目。它提供了一个图形用户界面，支持对SVG文件进行编辑、保存以及查看SVG文件内容。

**项目亮点：**

1. 采用单例模式负责全局数据的唯一管理，采用简单工厂模式，统一接口创建图形对象；
2. 采用MVC三层架构设计结合观察者模式，实现画布视图与参数栏视图的数据同步；
3. 在SVG编辑窗口，重写鼠标滚轮事件实现画布缩放；在画布中，重写鼠标移动、按下、释放等事件，实现图形绘制、编辑；
4. 基于QListWidget以及信号槽，实现画布参数栏和图形参数栏的切换；
5. 采用命令模式，用全局栈维护命令对象，实现了图形的创建和删除的撤销和重做；
6. 基于QT network模块，向服务端请求配置文案，显示功能按钮的说明弹窗。


## 模块介绍

#### UI设计

主窗口的大体框架是在.ui文件中拖入控件并在属性编辑器中调整尺寸、样式、边距和间距等。

每个模块的细化布局，是手写之后，通过提升的方式或加入布局的方式，完善至主窗口中。

#### 全局数据

将所有全局数据和相关的操作都放在一个文件中（kglobaldata.h 和 kglobaldata.cpp），可以方便地对这些数据进行集中管理。使用**单例模式**可以在任何地方方便地访问这些全局数据（画布和图形）。且单例模式确保只有一个实例存在，所有对全局数据的修改都将影响同一个实例。这有助于维护数据的一致性。


#### 左侧工具栏模块

KToolBar里面放置多个KToolButton，设置互斥，一次只能选择一个按钮按下。通过重写鼠标进入事件、离开事件，配合按钮触发槽函数，实现了按钮的状态切换。

#### 图形绘制模块

采用简单工厂模式，KShapeFactory中的静态成员函数集中创建图形对象、

KShape作为所有图形类的基类，定义了图形的基本属性（位置、尺寸、边框、填充）和通用操作（绘制、移动、获取类型、序列化）

派生类：class KPen、class KLine、class KCircle、class KRect、class KPent、class KHexa、class KStar、class KText、class KHeart、class KBubble

#### 画布模块

KSvgMainWindow继承自 QScrollArea，包含画布 KCanvas，处理鼠标滚轮缩放、键盘事件以及画布右键菜单相关的操作（全选、复制、粘贴、删除、图层、撤销/重做）。

KCanvas画布区域，负责图形的绘制、交互（鼠标事件）、选中、移动、新建、导入和保存。

#### 右侧参数栏模块

包括画布参数栏和图形参数栏，画布参数栏显示并设置画布参数，图形参数栏显示并编辑图形参数。基于KParamBox派生出3类参数框，分别为数值参数框、下拉选择框、颜色选择框。画布参数栏和图形参数栏包含这些参数框的组合。

基于QListWidget，根据鼠标按下事件中鼠标选中的是图形还是画布/已选中图形列表是否为空，发送对应的信号，主窗口接受信号并调用相应的槽函数进行处理（显示一个参数栏、隐藏另一个），实现画布参数栏和图形参数栏的切换。

#### MVC架构设计

MVC 的核心思想是**Model 层独立于 View 层**，View 层应通过 **Controller** 层间接依赖 Model 层。

优点：**代码解耦**（三个层级间的低耦合性使得代码更易于维护和修改）；**分工明确**（前端和后端分别负责视图和模型的开发，提升效率）

- **Model层**：存储图形的唯一数据源（如位置、大小、颜色等参数），**提供数据修改接口**。
- **View 层：**分为两个视图实现（**画布视图 + 参数栏视图**），均依赖 Model 数据渲染。
- **Controller 层**：**接收两个视图的用户操作**，调用Model层的数据修改接口，避免视图直接操作数据。


#### 画布区域和参数栏区域的数据同步

1.**初始方案：**

当修改参数栏中的参数，会触发参数更新的槽函数，将参数栏中的参数写进全局的画布参数/图形参数，并同步给画布（判断当前设置的参数与之前是否相同，若相同则直接返回，不再进行后续不必要操作）和画布中的当前图形。

当选中当前图形、移动图形边框，会触发参数更新的槽函数，将当前图形参数写入全局的图形参数，并同步给参数栏。

即让Model层与View层各自持有一份图形数据的共享指针，实现数据同步。

2.**存在问题**：

- 多线程情况下的并发读写的问题，如一个线程在Model层通过指针写数据，而另一个线程在View层通过指针读数据。
- 数据流混乱：不符合 MVC 中 “Model 状态变化通知 View 更新，View 操作通过 Controller 影响 Model” 的单向数据流设计。

3.解决方案：**MVC+观察者模式**

- **Model层**：存储图形的唯一数据源（如位置、大小、颜色等参数），**提供数据修改接口**，并维护**观察者列表**。
- **View 层：**分为两个视图实现（**画布视图 + 参数栏视图**），均依赖 Model 数据渲染，且**作为观察者监听 Model 变化**。
- **Controller 层**：**接收两个视图的用户操作**，调用Model层的数据修改接口，避免视图直接操作数据。

#### 撤销、重做模块

**命令模式实现撤销、重做**，核心思想：**将操作封装为命令对象**，管理命令对象的执行、撤销

- **撤销功能**：**执行命令**时将命令压**入栈**，**撤销**时从栈顶取出命令并调用其`undo()`方法
- **重做功能**：额外维护一个 "**重做栈**"，当**撤销**操作发生时，将被撤销的命令从主栈弹出并**压入重做栈**，**重做**时从**重做栈取出命令**并调用其`execute()`方法


#### 内存管理

当类对象或结构体对象作为另一个类的成员变量时，采用对象指针的形式。



